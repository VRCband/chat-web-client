import{o as j,u as y,a as b,R as i,r as w,j as e,F as A,b as S,c as o,g as L,d as P,p as v,e as R,v as k,l as E}from"./DeTGZYeDNQQzD2Hg2g8t.js";import{b as p}from"./aoPSPIEkzX_tTBd7Zx1e.js";import"./BHK_RXqSZtQyL1LaPu5h.js";import{E as G}from"./BHSo5O2nUoh1F0gkb80g.js";import{L as N}from"./B917TLmZ68jbW8Lby7cL.js";import{u as V}from"./DMCex30FeWvvThtDj-pY.js";import{A as l}from"./CbUDGFpacXBtqKbCApUy.js";import{L as C}from"./B4e3G5sn1kXF-PPzYHka.js";import{L as I}from"./rfKdPwl_G1WqjosHyTVV.js";import{N as F}from"./Bnfz9_I8WWs2PCeIeEay.js";import{R as T}from"./8Xsdg-PZQxZ37OkVeoLc.js";import{C as q}from"./lcTfp6ABnDdcLHMt5TJ2.js";import{G as m}from"./aw3wHiZxDYoFCCMsbTym.js";import{A as a}from"./BDy-IalVzQHWQnfmhnMI.js";import{u as O}from"./RfSsDsLnzSmF70stwuXp.js";import{I as U}from"./BB3IDxfmvJHFgRosf0Ku.js";import{i as W}from"./BvFgMfzu9O3nUQg8aBdA.js";function B(){const t=O(),n=V("App"),c=y(),r=b();return i.useEffect(()=>{const f=w(()=>t.token,s=>{s?(t.rest.setToken(s),t.gateway.readyState===WebSocket.CLOSED?(t.setGatewayReady(!1),t.gateway.connect(m.routeSettings.gateway)):n.debug("Gateway connect called but socket is not closed")):(n.debug("user no longer authenticated"),t.gateway.readyState===WebSocket.OPEN&&t.gateway.disconnect(1e3,"user is no longer authenticated"),c("/"))});return W&&(async()=>{const[s,u,g,d,h,x]=await Promise.all([L(),P(),v(),R(),k(),E()]);window.globals={tauriVersion:s,appVersion:u,platform:{name:g,arch:d,version:h,locale:x}}})(),m.load(),t.loadSettings(),n.debug("Loading complete"),t.setAppLoading(!1),f},[]),i.useEffect(()=>{r.online?p.remove("offline"):p.push({type:"offline"},"offline")},[r]),e.jsxs(G,{section:"app",children:[t.fpsShown&&e.jsx(A,{}),e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(o,{index:!0,path:"/",element:e.jsx(a,{component:l})}),e.jsx(o,{path:"/app",element:e.jsx(a,{component:l})}),e.jsx(o,{path:"/channels/:guildId/:channelId?",element:e.jsx(a,{component:q})}),e.jsx(o,{path:"/login",element:e.jsx(a,{requireUnauthenticated:!0,component:C})}),e.jsx(o,{path:"/register",element:e.jsx(a,{requireUnauthenticated:!0,component:T})}),e.jsx(o,{path:"/logout",element:e.jsx(a,{component:I})}),e.jsx(o,{path:"/invite/:code",element:e.jsx(U,{})}),e.jsx(o,{path:"*",element:e.jsx(F,{})})]})})]})}const re=j(B);export{re as A};
