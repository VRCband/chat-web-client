import{o as j,u as y,a as b,R as i,r as w,j as e,F as A,b as S,c as o,g as L,d as P,p as v,e as R,v as k,l as E}from"./YuA7MKX-N8BBDZOAxa77.js";import{b as p}from"./Brb8PTFQ5cVTanKesoX8.js";import"./T1foqc7-uYwh_aFL1pq4.js";import{E as G}from"./CVXVHqccrEbvnqt0GI70.js";import{L as N}from"./BISAxKZj-y4HcSGZmDJ9.js";import{u as V}from"./DMCex30FeWvvThtDj-pY.js";import{A as l}from"./fT3FaAZ6gIlz4JhiYTtD.js";import{L as C}from"./jpr5zRSfkLA0lpGHkX4h.js";import{L as I}from"./DT1KrL2O_JSR5yUQF917.js";import{N as F}from"./CFqVORh7oNzWwMtJTiZf.js";import{R as T}from"./B30zZBHOHV-LGWV7TDCW.js";import{C as q}from"./CnjDyppIBMwNLIzUfflK.js";import{G as m}from"./aw3wHiZxDYoFCCMsbTym.js";import{A as a}from"./BDjZB9eqDa1bmkvQwTKB.js";import{u as O}from"./CyJ5WJXEKPq0b3c1ZbHJ.js";import{I as U}from"./zBjCMMwo2yaoY_iZG82_.js";import{i as W}from"./BehbJKW-Ic5ZiA7tfWXx.js";function B(){const t=O(),n=V("App"),c=y(),r=b();return i.useEffect(()=>{const f=w(()=>t.token,s=>{s?(t.rest.setToken(s),t.gateway.readyState===WebSocket.CLOSED?(t.setGatewayReady(!1),t.gateway.connect(m.routeSettings.gateway)):n.debug("Gateway connect called but socket is not closed")):(n.debug("user no longer authenticated"),t.gateway.readyState===WebSocket.OPEN&&t.gateway.disconnect(1e3,"user is no longer authenticated"),c("/"))});return W&&(async()=>{const[s,u,g,d,h,x]=await Promise.all([L(),P(),v(),R(),k(),E()]);window.globals={tauriVersion:s,appVersion:u,platform:{name:g,arch:d,version:h,locale:x}}})(),m.load(),t.loadSettings(),n.debug("Loading complete"),t.setAppLoading(!1),f},[]),i.useEffect(()=>{r.online?p.remove("offline"):p.push({type:"offline"},"offline")},[r]),e.jsxs(G,{section:"app",children:[t.fpsShown&&e.jsx(A,{}),e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(o,{index:!0,path:"/",element:e.jsx(a,{component:l})}),e.jsx(o,{path:"/app",element:e.jsx(a,{component:l})}),e.jsx(o,{path:"/channels/:guildId/:channelId?",element:e.jsx(a,{component:q})}),e.jsx(o,{path:"/login",element:e.jsx(a,{requireUnauthenticated:!0,component:C})}),e.jsx(o,{path:"/register",element:e.jsx(a,{requireUnauthenticated:!0,component:T})}),e.jsx(o,{path:"/logout",element:e.jsx(a,{component:I})}),e.jsx(o,{path:"/invite/:code",element:e.jsx(U,{})}),e.jsx(o,{path:"*",element:e.jsx(F,{})})]})})]})}const re=j(B);export{re as A};
