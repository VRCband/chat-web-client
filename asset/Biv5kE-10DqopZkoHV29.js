import{u as h,R as x,ad as j,w as f,j as e}from"./YuA7MKX-N8BBDZOAxa77.js";import{S as b}from"./CF6FO32TaLC-BNF6DE7O.js";import{W as k,A as y,H as F,i as S,S as L,F as I,d as T,L as A,b as C,a as E,c as w,I as B,e as v,j as H}from"./ILN8eB9yg5xHXvAXE1mm.js";import{T as R}from"./BTnekbDuzfJChn_J3HiX.js";import{u as W}from"./CyJ5WJXEKPq0b3c1ZbHJ.js";import{u as M}from"./DMCex30FeWvvThtDj-pY.js";import"./BUjYG6qMQjp0KnokeClt.js";import"./b9QDabEUvKe6AI27JKho.js";import{m as q}from"./BehbJKW-Ic5ZiA7tfWXx.js";function P(o){const i=W(),u=M("MFA"),d=h(),[n,c]=x.useState(!1),{register:m,handleSubmit:p,formState:{errors:t},setError:s}=j(),l=p(g=>{c(!0),i.rest.post(f.mfaTotp(),{...g,ticket:o.ticket}).then(r=>{i.setToken(r.token,!0),d("/app",{replace:!0})}).catch(r=>{if("message"in r)if(r.errors){const a=q(r.errors);a?s(a.field,{type:"manual",message:a.error}):s("code",{type:"manual",message:r.message})}else s("code",{type:"manual",message:r.message});else u.error(r),s("code",{type:"manual",message:"Unknown Error"})}).finally(()=>c(!1))});return e.jsx(k,{children:e.jsx(y,{children:e.jsxs(F,{children:[e.jsx(b,{height:48,width:"auto"}),e.jsx(S,{children:"Two-factor authentication"}),e.jsx(L,{children:"You can use a backup code or your two-factor authentication mobile app."}),e.jsxs(I,{onSubmit:l,children:[e.jsxs(T,{marginBottom:!0,style:{marginTop:0},children:[e.jsxs(A,{error:!!t.code,children:[e.jsx(C,{children:"Enter 2FA/Backup Code"}),t.code&&e.jsx(E,{children:e.jsxs(e.Fragment,{children:[e.jsx(R,{children:"-"}),t.code.message]})})]}),e.jsx(w,{children:e.jsx(B,{type:"text",autoFocus:!0,...m("code",{required:!0}),error:!!t.code,disabled:n,placeholder:"6-digit authentication code/8-digit backup code"})})]}),e.jsx(v,{palette:"primary",type:"submit",disabled:n,children:"Log In"}),e.jsx(H,{onClick:()=>o.close(),type:"button",children:"Go Back to Login"})]})]})})})}export{P as M};
